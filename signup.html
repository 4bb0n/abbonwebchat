<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Account</title>
    <style>
        body{
            text-align: center;
        }
        h1{
            font-family: Verdana, Geneva, Tahoma, sans-serif;
        }
        input{
            height: 40px;
            width: 225px;
            border-radius: 10px;
            font-size: 20px;
            border-width: 1px;
            font-family: monospace;
            background-color: rgb(0, 8, 33);
            color: white;
            box-shadow: none;
            bottom: 40px;
            margin-top: 10px;
        }
        #password{
            position: relative;
        }
        #username{
            position: relative;
            bottom: 40px;
        }
        #createAccountBtn{
            position: relative;
            height: 50px;
            width: 200px;
            font-size: large;
            margin-top: 10px;
            background-color: whitesmoke;
            cursor: pointer;
            box-shadow: 2px 2px 2px black;
        }
        #createAccountBtn:hover{
            background-color: rgb(226, 226, 226);
        }
        #loginForm{
            position: relative;
            align-content: center;
            left: 550px;
            margin-top: 100px;
            background-color: lightgray;
            width: 400px;
            height: 400px;
            box-shadow: 4px 4px 4px black;
        }
    </style>
</head>
<body>
    <h1>By creating an account, no one else can have the same name as you!</h1>
    <div id="loginForm">
    <input type="text" id="username" placeholder="username"><br>
    <input type="text" id="password" placeholder="password"><br>
    <button id="createAccountBtn">Create Account</button>
    </div>
    <script src="index.cjs"></script>
    <script src="https://cdn.socket.io/4.5.4/socket.io.js"></script>
    <script>
        const socket = io();
        const createAccountBtn = document.getElementById("createAccountBtn");
        createAccountBtn.onclick = () => {
            const username = document.getElementById("username").value;
            const password = document.getElementById("password").value;
            socket.emit("checkForSameName", username);
            if(username && password) {
            const account = [username, password]
            let accOrder = checkAccounts()
            if(accOrder == 0){
                localStorage.setItem("account", account);
            }
            else{
                localStorage.setItem("account" + accOrder, account);
            }
            window.open('/', '_self');
            }
            else{
                alert("Pleaase enter your username and password")
            }
        };
        function checkAccounts(){
            let account = localStorage.getItem("account")
            let account2 = localStorage.getItem("account2")
            let account3 = localStorage.getItem("account3")
            let account4 = localStorage.getItem("account4")
            let account5 = localStorage.getItem("account5")
            let account6 = localStorage.getItem("account6")
            let account7 = localStorage.getItem("account7")
            let account8 = localStorage.getItem("account8")
            let account9 = localStorage.getItem("account9")
            let account10 = localStorage.getItem("account10")
            let account11 = localStorage.getItem("account11")

            let accountList = [account, account2, account3, account4, account5, account6, account7, account8, account9, account10, account11]
            let index = accountList.findIndex(findUndefined)
            function findUndefined(x){
                return x == undefined;
            }
            return index;
        }
    </script>
</body>
</html>
